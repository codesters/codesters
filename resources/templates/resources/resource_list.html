{% extends "resources/base.html" %}
{% load url from future %}
{% load age website active from codesters %}
{% load ratings %}
{% block resource_content %}
<div class="row-fluid">
    <div class="span9">
        <ul class="nav nav-tabs">
            <li class="{% active resquest.path '.+recent$' %}"><a href="?o=recent"><i class="icon-time"></i> Recent</a></li>
            <li class="{% active resquest.path popular_tab %}"><a href="?o=popular"><i class="icon-fire"></i> Popular</a></li>
        </ul>
        {% for resource in resources %}
        <div class="row-fluid">
            <div class="span12 resource resource-{{ resource.resource_type.color }}">
                <h3><a href="{{ resource.url }}">{{ resource.title }}</a> <small>{{ resource.url|website }}</small></h3>
                        <p><small>submitted  {{ resource.created_at|age  }} by 
                                <a href="{{ resource.created_by.userprofile.get_absolute_url }}">{{ resource.created_by }}</a> in 
                                <a href="{% url 'resource_list' slug=resource.resource_type.slug %}">{{ resource.resource_type }}</a>
                        </small> </p>
                        <a href="{% url 'resource_detail' pk=resource.id %}" class="btn btn-small"><i class="icon-file"></i> Details</a> 

                        {% if user.is_authenticated %}
                        {% rating_by_user user on resource.rating as vote %}
                        {% if vote > 1 %}
                        <a href="#" class="btn btn-small disabled">Voted</a>
                        {% else %}
                        <div class="btn-group">
                            <a href="{% url 'resource_rate' object_id=resource.pk score=1 %}" class="btn btn-small"><i class="icon-star{% if vote > 0 %}{% else %}-empty{% endif %}"></i> </a>
                            <a href="{% url 'resource_rate' object_id=resource.pk score=2 %}" class="btn btn-small"><i class="icon-star{% if vote > 1 %}{% else %}-empty{% endif %}"></i> </a>
                            <a href="{% url 'resource_rate' object_id=resource.pk score=3 %}" class="btn btn-small"><i class="icon-star{% if vote > 2 %}{% else %}-empty{% endif %}"></i> </a>
                            <a href="{% url 'resource_rate' object_id=resource.pk score=4 %}" class="btn btn-small"><i class="icon-star{% if vote > 3 %}{% else %}-empty{% endif %}"></i> </a>
                            <a href="{% url 'resource_rate' object_id=resource.pk score=5 %}" class="btn btn-small"><i class="icon-star{% if vote > 4 %}{% else %}-empty{% endif %}"></i> </a>
                        </div>
                        {% endif %}
                        {% ifequal resource.created_by user %}<a href="{% url 'resource_update' pk=resource.id %}" class="btn btn-small"><i class="icon-edit"></i> Edit</a>{% endifequal %}
                        {% endif %}
            </div>
        </div>
        {% empty %}
        <div class="row-fluid">
            <div class="span12">
                <h3>Sorry, there are no resources here.</h3>
            </div>
        </div>
        {% endfor %}
    {% include "pagination.html" %}
    </div>
    <div class="span3 well">{% include "resources/topics.html" %}</div>
</div>
{% endblock %}
